var e={441:(e,t,n)=>{var a;!function(r,o,l){if(r){for(var i,c={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},u={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},p={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},d=1;d<20;++d)c[111+d]="f"+d;for(d=0;d<=9;++d)c[d+96]=d.toString();g.prototype.bind=function(e,t,n){var a=this;return e=e instanceof Array?e:[e],a._bindMultiple.call(a,e,t,n),a},g.prototype.unbind=function(e,t){return this.bind.call(this,e,(function(){}),t)},g.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},g.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},g.prototype.stopCallback=function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1)return!1;if(b(t,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var n=e.composedPath()[0];n!==e.target&&(t=n)}return"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},g.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},g.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(c[t]=e[t]);i=null},g.init=function(){var e=g(o);for(var t in e)"_"!==t.charAt(0)&&(g[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},g.init(),r.Mousetrap=g,e.exports&&(e.exports=g),void 0===(a=function(){return g}.call(t,n,t,e))||(e.exports=a)}function y(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function f(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return c[e.which]?c[e.which]:u[e.which]?u[e.which]:String.fromCharCode(e.which).toLowerCase()}function m(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function h(e,t,n){return n||(n=function(){if(!i)for(var e in i={},c)e>95&&e<112||c.hasOwnProperty(e)&&(i[c[e]]=e);return i}()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function v(e,t){var n,a,r,o=[];for(n=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),r=0;r<n.length;++r)a=n[r],p[a]&&(a=p[a]),t&&"keypress"!=t&&s[a]&&(a=s[a],o.push("shift")),m(a)&&o.push(a);return{key:a,modifiers:o,action:t=h(a,o,t)}}function b(e,t){return null!==e&&e!==o&&(e===t||b(e.parentNode,t))}function g(e){var t=this;if(e=e||o,!(t instanceof g))return new g(e);t.target=e,t._callbacks={},t._directMap={};var n,a={},r=!1,l=!1,i=!1;function c(e){e=e||{};var t,n=!1;for(t in a)e[t]?n=!0:a[t]=0;n||(i=!1)}function u(e,n,r,o,l,i){var c,u,s,p,d=[],y=r.type;if(!t._callbacks[e])return[];for("keyup"==y&&m(e)&&(n=[e]),c=0;c<t._callbacks[e].length;++c)if(u=t._callbacks[e][c],(o||!u.seq||a[u.seq]==u.level)&&y==u.action&&("keypress"==y&&!r.metaKey&&!r.ctrlKey||(s=n,p=u.modifiers,s.sort().join(",")===p.sort().join(",")))){var f=!o&&u.combo==l,h=o&&u.seq==o&&u.level==i;(f||h)&&t._callbacks[e].splice(c,1),d.push(u)}return d}function s(e,n,a,r){t.stopCallback(n,n.target||n.srcElement,a,r)||!1===e(n,a)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(n),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(n))}function p(e){"number"!=typeof e.which&&(e.which=e.keyCode);var n=f(e);n&&("keyup"!=e.type||r!==n?t.handleKey(n,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):r=!1)}function d(e,o,l,p,y){t._directMap[e+":"+l]=o;var m,h=(e=e.replace(/\s+/g," ")).split(" ");h.length>1?function(e,t,o,l){function u(t){return function(){i=t,++a[e],clearTimeout(n),n=setTimeout(c,1e3)}}function p(t){s(o,t,e),"keyup"!==l&&(r=f(t)),setTimeout(c,10)}a[e]=0;for(var y=0;y<t.length;++y){var m=y+1===t.length?p:u(l||v(t[y+1]).action);d(t[y],m,l,e,y)}}(e,h,o,l):(m=v(e,l),t._callbacks[m.key]=t._callbacks[m.key]||[],u(m.key,m.modifiers,{type:m.action},p,e,y),t._callbacks[m.key][p?"unshift":"push"]({callback:o,modifiers:m.modifiers,action:m.action,seq:p,level:y,combo:e}))}t._handleKey=function(e,t,n){var a,r=u(e,t,n),o={},p=0,d=!1;for(a=0;a<r.length;++a)r[a].seq&&(p=Math.max(p,r[a].level));for(a=0;a<r.length;++a)if(r[a].seq){if(r[a].level!=p)continue;d=!0,o[r[a].seq]=1,s(r[a].callback,n,r[a].combo,r[a].seq)}else d||s(r[a].callback,n,r[a].combo);var y="keypress"==n.type&&l;n.type!=i||m(e)||y||c(o),l=d&&"keydown"==n.type},t._bindMultiple=function(e,t,n){for(var a=0;a<e.length;++a)d(e[a],t,n)},y(e,"keypress",p),y(e,"keydown",p),y(e,"keyup",p)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a={};(()=>{n.d(a,{Z:()=>h});var e=n(441),t=n.n(e);let r={};const o={tabTitle:"CCC YouTube Timestamp with Player Control",settings:[{id:"grabTitleKey",name:"Grab Title Shortkey",description:"Paste the video title into the focused block",action:{type:"input",placeholder:"alt+a t",onChange:e=>{r.grabTitleKey=e.target.value}}},{id:"grabTimeKey",name:"Time Stamp Shortkey",description:"Paste the current playing time at the beginning of the focused block",action:{type:"input",placeholder:"alt+a n",onChange:e=>{r.grabTimeKey=e.target.value}}},{id:"normalSpeedKey",name:"Normal Speed Shortkey",description:"Set the playback speed to normal",action:{type:"input",placeholder:"alt+a 0",onChange:e=>{r.normalSpeedKey=e.target.value}}},{id:"speedUpKey",name:"Speed up by .25x Shortkey",description:"Increase the playback speed by .25x",action:{type:"input",placeholder:"alt+a =",onChange:e=>{r.speedUpKey=e.target.value}}},{id:"speedDownKey",name:"Speed down by .25x Shortkey",description:"Decrease the playback speed by .25x",action:{type:"input",placeholder:"alt+a -",onChange:e=>{r.speedDownKey=e.target.value}}},{id:"muteKey",name:"Mute Shortkey",description:"Mute the playback audio",action:{type:"input",placeholder:"alt+a m",onChange:e=>{r.muteKey=e.target.value}}},{id:"volUpKey",name:"Vol Up Shortkey",description:"Increase volume",action:{type:"input",placeholder:"alt+a i",onChange:e=>{r.volUpKey=e.target.value}}},{id:"volDownKey",name:"Vol Down Shortkey",description:"Decrease volume",action:{type:"input",placeholder:"alt+a k",onChange:e=>{r.volDownKey=e.target.value}}},{id:"playPauseKey",name:"Play Pause Shortkey",description:"Play/Pause the player",action:{type:"input",placeholder:"alt+a p",onChange:e=>{r.playPauseKey=e.target.value}}},{id:"backwardKey",name:"Backward Shortkey",description:"Go Backward",action:{type:"input",placeholder:"alt+a j",onChange:e=>{r.backwardKey=e.target.value}}},{id:"forwardKey",name:"ForwardKey Shortkey",description:"Go Forward",action:{type:"input",placeholder:"alt+a l",onChange:e=>{r.forwardKey=e.target.value}}}]};let l=[],i=null;const c=new Map;function u(){for(let e of c.values())if(1==e.getPlayerState())return e;return null}function s(){for(let[e,t]of c)if(null!==document.getElementById(e))return t;return null}function p(){var e=u();return null!==e?e:null!==i?i:c.size>0?s():null}function d(e){let t=document.querySelector("textarea.rm-block-input").id.slice(-9);y(t,e+" "+f(t)),new Promise((e=>setTimeout(e,300))),window.roamAlphaAPI.ui.setBlockFocusAndSelection({location:window.roamAlphaAPI.ui.getFocusedBlock(),selection:{start:8,end:8}})}const y=(e,t)=>window.roamAlphaAPI.updateBlock({block:{uid:e,string:t}}),f=e=>window.roamAlphaAPI.q(`[:find (pull ?block [:block/string])\n    :where [?block :block/uid "${e}"]]`)[0][0].string;function m(e,t,n){let a=e.settings.get(t);return null==a&&e.settings.set(t,n),a||n}const h={onload:function({extensionAPI:e}){r.grabTitleKey=m(e,"grabTitleKey","alt+a t"),r.grabTimeKey=m(e,"grabTimeKey","alt+a n"),r.normalSpeedKey=m(e,"normalSpeedKey","alt+a 0"),r.speedUpKey=m(e,"speedUpKey","alt+a ="),r.speedDownKey=m(e,"speedDownKey","alt+a -"),r.muteKey=m(e,"muteKey","alt+a m"),r.volUpKey=m(e,"volUpKey","alt+a i"),r.volDownKey=m(e,"volDownKey","alt+a k"),r.playPauseKey=m(e,"playPauseKey","alt+a p"),r.backwardKey=m(e,"backwardKey","alt+a j"),r.forwardKey=m(e,"forwardKey","alt+a l"),e.settings.panel.create(o),function(){const e=e=>e.parentElement.querySelector(".timestamp-control"),t=(e,t,n)=>{const a=document.createElement("button");a.innerText="â–º",a.classList.add("timestamp-control"),a.dataset.timestamp=t,a.addEventListener("click",n),e.parentElement.insertBefore(a,e)},n=e=>{var t=e.querySelector("span");if(null===t)return null;const n=t.textContent.match(/^((?:\d+:)?\d+:\d\d)\D/);if(!n||n.length<2)return null;const a=n[1].split(":").map((e=>parseInt(e)));return 3==a.length?3600*a[0]+60*a[1]+a[2]:2==a.length?60*a[0]+a[1]:null};let a=setInterval((()=>{if("undefined"==typeof YT||void 0===YT.Player){const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),clearInterval(a)}}),1e3),r=window.setInterval((()=>{"undefined"!=typeof YT&&Array.from(document.getElementsByTagName("IFRAME")).filter((e=>e.src.includes("youtube.com"))).forEach((a=>{if(null!==a.closest(".rm-zoom-item"))return;const r=a.closest(".roam-block-container");let o,l=!1;if(a.classList.contains("yt-activated"))o=a.id;else{var i=(s=a.src,(p=s.match(/^(https?:\/\/)?((www\.)?(youtube(-nocookie)?|youtube.googleapis)\.com.*(v\/|v=|vi=|vi\/|e\/|embed\/\/?|user\/.*\/u\/\d+\/)|youtu\.be\/)([_0-9a-z-]+)/i))&&11==p[7].length?p[7]:null);o="yt-"+a.closest(".roam-block").id;var u=document.createElement("div");u.id=o,a.parentNode.insertBefore(u,a),a.remove();let e=new window.YT.Player(o,{videoId:i}),t=document.getElementById(o);t.classList.add("rm-iframe","rm-video-player","yt-activated"),t.closest("div").classList.add("rm-iframe__container","rm-video-player__container","hoverparent"),c.set(o,e);const n=t.closest(".rm-iframe__spacing-wrapper")?.querySelector(".rm-video-player__comment-button");n.style.visibility="hidden",l=!0}var s,p;((a,r,o)=>{if(a.children.length<2)return null;Array.from(a.children[1].querySelectorAll(".rm-block__input")).forEach((a=>{if(!a.classList.contains("timestamp-observed")||o){const l=n(a),i=e(a),c=null!==i&&l!=i.dataset.timestamp;null!==i&&(null===l||c||o)&&i.remove(),null!==l&&(null===i||c||o)&&t(a,l,(()=>r.seekTo(l,!0))),a.classList.add("timestamp-observed")}}))})(r,c.get(o),l)}))}),1e3);l.push((()=>clearInterval(r)))}(),t().prototype.stopCallback=function(){return!1},t().bind(r.grabTitleKey,(async function(e){if(e.preventDefault(),"textarea"==e.srcElement.localName){var t=e.srcElement.closest(".roam-block-container").parentElement.closest(".roam-block-container").querySelector("iframe");if(null===t)return!1;d("**"+c.get(t.id).getVideoData().title+"**")}return!1}),"keydown"),t().bind(r.grabTimeKey,(async function(e){e.preventDefault();var t=p();return null!==t&&(d(new Date(1e3*t.getCurrentTime()).toISOString().substr(11,8)),!1)}),"keydown"),t().bind(r.playPauseKey,(async function(e){e.preventDefault();var t=u();return null!==t?(t.pauseVideo(),i=t,!1):null!==i?(i.playVideo(),i=null,!1):c.size>0&&null!==(t=s())&&(t.playVideo(),!1)}),"keydown"),t().bind(r.muteKey,(async function(e){e.preventDefault();var t=p();return null!==t&&(t.isMuted()?t.unMute():t.mute(),!1)}),"keydown"),t().bind(r.volUpKey,(async function(e){e.preventDefault();var t=p();return null!==t&&(t.setVolume(Math.min(t.getVolume()+10,100)),!1)}),"keydown"),t().bind(r.volDownKey,(async function(e){e.preventDefault();var t=p();return null!==t&&(t.setVolume(Math.max(t.getVolume()-10,0)),!1)}),"keydown"),t().bind(r.speedUpKey,(async function(e){e.preventDefault();var t=p();return null!==t&&(t.setPlaybackRate(Math.min(t.getPlaybackRate()+.25,2)),!1)}),"keydown"),t().bind(r.speedDownKey,(async function(e){e.preventDefault();var t=p();return null!==t&&(t.setPlaybackRate(Math.max(t.getPlaybackRate()-.25,0)),!1)}),"keydown"),t().bind(r.normalSpeedKey,(async function(e){e.preventDefault();var t=p();return null!==t&&(t.setPlaybackRate(1,0),!1)}),"keydown"),t().bind(r.forwardKey,(async function(e){e.preventDefault();var t=p();if(null!==t){var n=t.getDuration();return t.seekTo(Math.min(t.getCurrentTime()+10,n),!0),!1}return!1}),"keydown"),t().bind(r.backwardKey,(async function(e){e.preventDefault();var t=p();return null!==t&&(t.getDuration(),t.seekTo(Math.max(t.getCurrentTime()-10,0),!0),!1)}),"keydown")},onunload:function(){t().unbind(r.grabTitleKey),t().unbind(r.grabTimeKey),t().unbind(r.normalSpeedKey),t().unbind(r.speedUpKey),t().unbind(r.speedDownKey),t().unbind(r.muteKey),t().unbind(r.volUpKey),t().unbind(r.playPauseKey),t().unbind(r.backwardKey),t().unbind(r.forwardKey);for(const e of l)e();l=[]}}})();var r=a.Z;export{r as default};